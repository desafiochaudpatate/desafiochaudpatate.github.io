<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script src="javascripts/main.js"></script>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {packages: ['corechart', 'table']});
      google.charts.setOnLoadCallback(onLoadCallback);
      
      function handleQueryResponse2(response) {
      alert('handling');
      if (response.isError()) {
        alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
        return;
      }
    
      var data = response.getDataTable();
      alert(data);
      visualization = new google.visualization.Table(document.getElementById('ingredients'));
      visualization.draw(data, null);
  }
  
function onLoadCallback()
{
      // Define the chart to be drawn.
      var data = new google.visualization.DataTable();
      data.addColumn('string', 'Element');
      data.addColumn('number', 'Percentage');
      data.addRows([
        ['Nitrogen', 0.78],
        ['Oxygen', 0.21],
        ['Other', 0.01]
      ]);

      // Instantiate and draw the chart.
      var chart = new google.visualization.PieChart(document.getElementById('ingredients'));
      chart.draw(data, null);
    }
}
function getIngredients(full_name)
{
  //foods = ["coco", "cenoura", "repolho", "pão", "massa", "cereal", "gordura", "vegano", "vegana", "vegetariano", "vegetariana", "pancs", "rosa", "mandioca", "carne", "tâmara", "doce", "marisco", "tomate", "damasco", "nectarina", "erva-doce", "codorna", "doce", "vaca", "mate", "anis", "amora", "menta", "osso", "risoto", "ova", "ovo", "torta", "caviar", "morno", "cookie", "cheesecake", "tacos", "amido", "endro", "mostarda", "cítrico", "mandarina", "assado", "carneiro", "cordeiro", "ovelha", "pizza", "acre", "nata", "amêndoa", "aveia", "coca", "coca-cola", "ostra", "ricota", "vietnã", "vieira", "camarão", "corada", "corado", "iogurte", "síria", "canadá", "mel", "melado", "melada", "coentro", "arder", "pimenta", "chá", "especiaria", "índia", "cone", "purê", "maçã", "carolina", "profiterole", "negro", "preto", "sal", "cru", "aro", "coral", "licor", "pinot", "suco", "pasta", "copa", "pato", "prato", "sopa", "pé", "óleo", "lata", "canola", "louro", "praia", "cortar", "canela", "pote", "rolo", "cuia", "risole", "pera", "picles", "aipo", "panceta", "jabuticaba", "panc", "polenta", "naan", "calor", "seco", "porco", "torrar", "porto", "sagu", "roma", "romã", "rosca", "amendoim", "manjericão", "pesto", "cru", "isca", "nigéria", "rã", "guaco", "arruda", "grécia", "rússia", "sugar", "siri", "caranguejo", "pimenta", "orégano", "suécia", "regar", "cupim", "aipim", "mali", "estados unidos", "panela", "faca", "frio", "fogo", "madalena", "mandolim", "cifão", "anel", "liso", "lisa", "azul", "anil"];
  alert('before');
  var url='https://docs.google.com/spreadsheets/d/1rgFHL4Mxkio-l5mcI8kDtn8k5QzmOs2MG-0g58N3j5I/gviz/tq?tq=select+A'
  alert(url);
  var query = new google.visualization.Query(url);
  query.send(handleQueryResponse2);
  //TODO: add following word groups to the list: fruits and vegetables, plates, edible animals, countries, colors, edible fungi,
  //spices, diet types, textures, shapes, kitchen tools
  //TODO: disregard graphic accentuation (including the tilde and cedilla)
  //TODO: crawl the web (maybe wikipedia is enough?) getting food descriptions and model the documents to get only food-related words
  document.getElementById("ingredients").innerHTML = "";
  good_foods = [];

  for (i = 0; i < foods.length; i++)
  {
    food = foods[i];
    used_letters = [];
    rotten = 0;
    for (j = 0; j < food.length; j++)
    {
      letter = food[j];
      okay = 0;
      subname = full_name;
      while (subname.indexOf(letter) > -1)
      {
        where = subname.indexOf(letter);
        if (used_letters[where] == 1)
        {
          subname = subname.slice(where+1);
        }
        else
        {
          used_letters[where] = 1;
          okay = 1;
          break;
        }
      }
      if (!okay)
      {
        rotten = 1;
      }
    }
    if (!rotten)
    {
      good_foods.push(food);
      document.getElementById("ingredients").innerHTML += food + " ";
    }
  }
  
  return good_foods;
}
    </script>
    <title>crcons.github.io by crcons</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>crcons.github.io</h1>
        </header>

        <form>
          <input type="text" name="full_name">
          <button type="button" onclick="getIngredients(full_name.value)">Get my ingredients!</button>
        </form>
        <div id="ingredients"></div>

        <footer>
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>
        
      </div>
    </div>
  </body>
</html>
